# 解决全选频闪问题与版本记录

## 1. 核心修复策略：事件驱动替代属性监听
*   **当前问题**: `MutationObserver` 监听 Checkbox 的 `attributes` 变化过于敏感，容易与我们的同步逻辑形成“修改->触发->修改”的死循环，导致 UI 频闪。
*   **解决方案**:
    1.  **移除 Observer 监听**: 在 `startObserver` 中，停止对 `INPUT` 和 `MAT-CHECKBOX` 属性变化的监听。
    2.  **引入事件监听**: 使用全局 `change` 事件监听器（Capture Phase）。只有当用户真实交互（点击/键盘）导致状态改变时，才触发 View 同步。这是最自然、最稳定的同步时机。
    3.  **保留兜底**: 保留 Observer 对 DOM 结构变化（添加/删除节点）的监听，以应对列表加载等情况。

## 2. 版本管理
*   **Manifest**: 升级至 `3.0.0.13`。
*   **Changelog**: 记录此次修复（Fix NotebookLM Checkbox Flickering）。

## 3. 执行步骤
1.  修改 `content_notebooklm.js`:
    *   移除 `startObserver` 中的 Checkbox 属性监听逻辑。
    *   在 `init` 中调用新函数 `setupNativeCheckboxListener`。
    *   实现 `setupNativeCheckboxListener`，监听 `change` 事件并调用 `syncViewFromNative`。
2.  更新 `manifest.json` 至 `3.0.0.13`。
3.  更新 `CHANGELOG.md`。

此方案将从根本上切断频闪的反馈回路。
